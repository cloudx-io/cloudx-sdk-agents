# CloudX SDK Version Tracking for Agent Documentation (Multi-Platform)
# This file tracks SDK versions across platforms that agent documentation is synchronized with

# Platform-specific SDK versions
platforms:
  android:
    sdk_version: "0.6.1"
    agents_last_updated: "2025-11-10"
    verified_against_commit: "ea8cffb"  # Add BuildInfoProvider abstraction and improve test coverage

  flutter:
    sdk_version: "0.1.2"
    flutter_sdk_min: "3.0.0"
    dart_sdk_min: "3.0.0"
    agents_last_updated: "2025-11-04"
    verified_against_commit: "TBD"  # Initial Flutter agent implementation

  ios:
    sdk_version: "1.2.0"
    ios_deployment_target: "14.0"
    agents_last_updated: "2025-11-14"
    verified_against_commit: "TBD"  # Initial iOS agent implementation

# Critical API signatures that agents depend on (Platform-specific)
api_signatures:
  android:
    initialization:
      class: "CloudXInitializationParams"
      constructor: "CloudXInitializationParams(appKey: String, testMode: Boolean = false)"
      listener: "CloudXInitializationListener"
      callbacks:
        - "onInitialized()"
        - "onInitializationFailed(cloudXError: CloudXError)"

    banner:
      factory: "CloudX.createBanner(placementName: String): CloudXAdView"
      listener: "CloudXAdViewListener"
      load_required: true
      callbacks:
        - "onAdLoaded(cloudXAd: CloudXAd)"
        - "onAdLoadFailed(cloudXError: CloudXError)"
        - "onAdDisplayed(cloudXAd: CloudXAd)"
        - "onAdClicked(cloudXAd: CloudXAd)"
        - "onAdHidden(cloudXAd: CloudXAd)"
        - "onAdDisplayFailed(cloudXError: CloudXError)"
        - "onAdExpanded(cloudXAd: CloudXAd)"
        - "onAdCollapsed(cloudXAd: CloudXAd)"

    interstitial:
      factory: "CloudX.createInterstitial(placementName: String): CloudXInterstitialAd"
      listener: "CloudXInterstitialListener"
      load_required: true
      ready_check: "isAdReady: Boolean"  # property, not method
      show_method: "show()"  # no parameters
      callbacks:
        - "onAdLoaded(cloudXAd: CloudXAd)"
        - "onAdLoadFailed(cloudXError: CloudXError)"
        - "onAdDisplayed(cloudXAd: CloudXAd)"
        - "onAdClicked(cloudXAd: CloudXAd)"
        - "onAdHidden(cloudXAd: CloudXAd)"
        - "onAdDisplayFailed(cloudXError: CloudXError)"

    rewarded:
      factory: "CloudX.createRewardedInterstitial(placementName: String): CloudXRewardedInterstitialAd"
      listener: "CloudXRewardedInterstitialListener"
      load_required: true
      ready_check: "isAdReady: Boolean"
      show_method: "show()"
      callbacks:
        - "onAdLoaded(cloudXAd: CloudXAd)"
        - "onAdLoadFailed(cloudXError: CloudXError)"
        - "onAdDisplayed(cloudXAd: CloudXAd)"
        - "onAdClicked(cloudXAd: CloudXAd)"
        - "onAdHidden(cloudXAd: CloudXAd)"
        - "onAdDisplayFailed(cloudXError: CloudXError)"
        - "onUserRewarded(cloudXAd: CloudXAd)"

    privacy:
      class: "CloudXPrivacy"
      constructor: "CloudXPrivacy(isUserConsent: Boolean?, isAgeRestrictedUser: Boolean?)"
      setter: "CloudX.setPrivacy(privacy: CloudXPrivacy)"

  flutter:
    initialization:
      method: "CloudX.initialize({required String appKey, bool allowIosExperimental}): Future<bool>"
      async: true

    banner:
      widget: "CloudXBannerView(placementName: String, listener: CloudXAdViewListener?)"
      factory: "CloudX.createBanner({required String placementName, String? adId, CloudXAdViewListener? listener, AdViewPosition? position}): Future<String?>"
      load_method: "CloudX.loadBanner({required String adId}): Future<bool>"
      show_method: "CloudX.showBanner({required String adId}): Future<bool>"
      destroy_required: true
      listener: "CloudXAdViewListener"
      callbacks:
        - "onAdLoaded(CloudXAd ad)"
        - "onAdLoadFailed(String error)"
        - "onAdDisplayed(CloudXAd ad)"
        - "onAdClicked(CloudXAd ad)"
        - "onAdHidden(CloudXAd ad)"
        - "onAdDisplayFailed(String error)"
        - "onAdExpanded(CloudXAd ad)"
        - "onAdCollapsed(CloudXAd ad)"

    mrec:
      widget: "CloudXMRECView(placementName: String, listener: CloudXAdViewListener?)"
      factory: "CloudX.createMREC({required String placementName, String? adId, CloudXAdViewListener? listener, AdViewPosition? position}): Future<String?>"
      load_method: "CloudX.loadMREC({required String adId}): Future<bool>"
      show_method: "CloudX.showMREC({required String adId}): Future<bool>"
      ready_check: "CloudX.isMRECReady({required String adId}): Future<bool>"
      destroy_required: true

    interstitial:
      factory: "CloudX.createInterstitial({required String placementName, String? adId, CloudXInterstitialListener? listener}): Future<String?>"
      load_method: "CloudX.loadInterstitial({required String adId}): Future<bool>"
      show_method: "CloudX.showInterstitial({required String adId}): Future<bool>"
      ready_check: "CloudX.isInterstitialReady({required String adId}): Future<bool>"
      destroy_required: true
      listener: "CloudXInterstitialListener"
      callbacks:
        - "onAdLoaded(CloudXAd ad)"
        - "onAdLoadFailed(String error)"
        - "onAdDisplayed(CloudXAd ad)"
        - "onAdClicked(CloudXAd ad)"
        - "onAdHidden(CloudXAd ad)"
        - "onAdDisplayFailed(String error)"

    privacy:
      ccpa: "CloudX.setCCPAPrivacyString(String? ccpaString): Future<void>"
      gpp: "CloudX.setGPPString(String? gppString): Future<void>"
      gpp_sid: "CloudX.setGPPSid(List<int>? sectionIds): Future<void>"
      coppa: "CloudX.setIsAgeRestrictedUser(bool isAgeRestricted): Future<void>"
      gdpr: "CloudX.setIsUserConsent(bool hasConsent): Future<void>  # NOT YET SUPPORTED by servers"

    lifecycle:
      destroy: "CloudX.destroyAd({required String adId}): Future<bool>"
      auto_refresh_start: "CloudX.startAutoRefresh({required String adId}): Future<bool>"
      auto_refresh_stop: "CloudX.stopAutoRefresh({required String adId}): Future<bool>"

  ios:
    initialization:
      class: "CloudXCore"
      method_objc: "- (void)initializeSDKWithAppKey:(NSString *)appKey completion:(nullable void (^)(BOOL success, NSError * _Nullable error))completion"
      method_swift: "CloudXCore.shared.initializeSDK(appKey: String, completion: @escaping (Bool, Error?) -> Void)"
      singleton: "[CloudXCore shared]"  # Objective-C
      singleton_swift: "CloudXCore.shared"

    banner:
      factory_objc: "- (nullable CLXBannerAdView *)createBannerWithPlacement:(NSString *)placement viewController:(UIViewController *)viewController delegate:(nullable id<CLXBannerDelegate>)delegate tmax:(nullable NSNumber *)tmax"
      factory_swift: "createBanner(placement: String, viewController: UIViewController, delegate: CLXBannerDelegate?, tmax: NSNumber?) -> CLXBannerAdView?"
      delegate: "CLXBannerDelegate"
      auto_load: true
      view_controller_required: true
      callbacks:
        - "bannerDidLoad:(_:CLXBannerAdView)"
        - "bannerDidFailToLoad:(_:CLXBannerAdView, withError:Error)"
        - "bannerWasClicked:(_:CLXBannerAdView)"
        - "bannerDidPresentScreen:(_:CLXBannerAdView)"
        - "bannerDidDismissScreen:(_:CLXBannerAdView)"

    mrec:
      factory_objc: "- (nullable CLXMRECAdView *)createMRECWithPlacement:(NSString *)placement viewController:(UIViewController *)viewController delegate:(nullable id<CLXMRECDelegate>)delegate tmax:(nullable NSNumber *)tmax"
      factory_swift: "createMREC(placement: String, viewController: UIViewController, delegate: CLXMRECDelegate?, tmax: NSNumber?) -> CLXMRECAdView?"
      delegate: "CLXMRECDelegate"
      auto_load: true
      view_controller_required: true

    interstitial:
      factory_objc: "- (nullable CLXInterstitial *)createInterstitialWithPlacement:(NSString *)placement delegate:(nullable id<CLXInterstitialDelegate>)delegate tmax:(nullable NSNumber *)tmax"
      factory_swift: "createInterstitial(placement: String, delegate: CLXInterstitialDelegate?, tmax: NSNumber?) -> CLXInterstitial?"
      delegate: "CLXInterstitialDelegate"
      auto_load: true
      show_method_objc: "- (void)showFromViewController:(UIViewController *)viewController"
      show_method_swift: "show(from: UIViewController)"
      callbacks:
        - "interstitialDidLoad:(_:CLXInterstitial)"
        - "interstitialDidFailToLoad:(_:CLXInterstitial, withError:Error)"
        - "interstitialDidDisplay:(_:CLXInterstitial)"
        - "interstitialWasClicked:(_:CLXInterstitial)"
        - "interstitialDidDismiss:(_:CLXInterstitial)"
        - "interstitialDidFailToDisplay:(_:CLXInterstitial, withError:Error)"

    rewarded:
      factory_objc: "- (nullable CLXRewardedAd *)createRewardedWithPlacement:(NSString *)placement delegate:(nullable id<CLXRewardedDelegate>)delegate tmax:(nullable NSNumber *)tmax"
      factory_swift: "createRewarded(placement: String, delegate: CLXRewardedDelegate?, tmax: NSNumber?) -> CLXRewardedAd?"
      delegate: "CLXRewardedDelegate"
      auto_load: true
      show_method_objc: "- (void)showFromViewController:(UIViewController *)viewController"
      show_method_swift: "show(from: UIViewController)"
      callbacks:
        - "rewardedDidLoad:(_:CLXRewardedAd)"
        - "rewardedDidFailToLoad:(_:CLXRewardedAd, withError:Error)"
        - "rewardedDidDisplay:(_:CLXRewardedAd)"
        - "rewardedWasClicked:(_:CLXRewardedAd)"
        - "rewardedDidDismiss:(_:CLXRewardedAd)"
        - "rewardedDidFailToDisplay:(_:CLXRewardedAd, withError:Error)"
        - "rewardedUserDidEarnReward:(_:CLXRewardedAd)"

    native:
      factory_objc: "- (nullable CLXNativeAd *)createNativeWithPlacement:(NSString *)placement viewController:(UIViewController *)viewController delegate:(nullable id<CLXNativeDelegate>)delegate tmax:(nullable NSNumber *)tmax"
      factory_swift: "createNative(placement: String, viewController: UIViewController, delegate: CLXNativeDelegate?, tmax: NSNumber?) -> CLXNativeAd?"
      delegate: "CLXNativeDelegate"
      auto_load: true
      view_controller_required: true

    privacy:
      ccpa_objc: "+ (void)setCCPAPrivacyString:(nullable NSString *)ccpaPrivacyString"
      ccpa_swift: "CloudXCore.setCCPAPrivacyString(_:String?)"
      gdpr_objc: "+ (void)setIsUserConsent:(BOOL)isUserConsent"
      gdpr_swift: "CloudXCore.setIsUserConsent(_:Bool)"
      coppa_objc: "+ (void)setIsAgeRestrictedUser:(BOOL)isAgeRestricted"
      coppa_swift: "CloudXCore.setIsAgeRestrictedUser(_:Bool)"
      note: "Privacy methods are class methods (+ prefix in ObjC, static in Swift concept)"

    ios_specific:
      packaging:
        cocoapods: "pod 'CloudXCore', '~> 1.2.0'"
        spm: ".package(url: \"https://github.com/cloudx-io/cloudx-ios\", from: \"1.2.0\")"
      key_differences_from_android:
        - "iOS ads auto-load (no explicit .load() call needed)"
        - "iOS requires UIViewController for banner/MREC/native ad creation"
        - "iOS delegates are protocols (not interfaces like Android)"
        - "iOS privacy methods are class methods (+ prefix)"
        - "iOS fullscreen ads use showFromViewController: method"
        - "iOS uses completion callbacks (^) for async operations"

# Files that contain API references (must be updated when SDK changes)
agent_files:
  android:
    - path: ".claude/agents/android/cloudx-android-integrator.md"
      api_references:
        - "CloudXInitializationParams"
        - "CloudXInitializationListener"
        - "CloudX.createBanner"
        - "CloudX.createInterstitial"
        - "CloudX.createRewardedInterstitial"
        - "CloudXAdViewListener"
        - "CloudXInterstitialListener"
        - "CloudXRewardedInterstitialListener"
        - "isAdReady"
        - "show()"
        - "load()"

    - path: ".claude/agents/android/cloudx-android-auditor.md"
      api_references:
        - "onAdLoadFailed"
        - "CloudXError"
        - "isAdReady"

    - path: ".claude/agents/android/cloudx-android-build-verifier.md"
      api_references:
        - "Gradle build validation"

    - path: ".claude/agents/android/cloudx-android-privacy-checker.md"
      api_references:
        - "CloudXPrivacy"
        - "isUserConsent"
        - "isAgeRestrictedUser"
        - "CloudX.setPrivacy"

    - path: "docs/android/INTEGRATION_GUIDE.md"
      api_references:
        - "ALL"

    - path: "docs/android/ORCHESTRATION.md"
      api_references:
        - "ALL"

  flutter:
    - path: ".claude/agents/flutter/cloudx-flutter-integrator.md"
      api_references:
        - "CloudX.initialize"
        - "CloudXBannerView"
        - "CloudXMRECView"
        - "CloudX.createBanner"
        - "CloudX.createInterstitial"
        - "CloudX.createMREC"
        - "CloudXAdViewListener"
        - "CloudXInterstitialListener"
        - "CloudX.loadBanner"
        - "CloudX.loadInterstitial"
        - "CloudX.showInterstitial"
        - "CloudX.isInterstitialReady"
        - "CloudX.destroyAd"

    - path: ".claude/agents/flutter/cloudx-flutter-auditor.md"
      api_references:
        - "onAdLoadFailed"
        - "CloudX.destroyAd"
        - "CloudX.stopAutoRefresh"

    - path: ".claude/agents/flutter/cloudx-flutter-build-verifier.md"
      api_references:
        - "Flutter build validation"

    - path: ".claude/agents/flutter/cloudx-flutter-privacy-checker.md"
      api_references:
        - "CloudX.setCCPAPrivacyString"
        - "CloudX.setGPPString"
        - "CloudX.setGPPSid"
        - "CloudX.setIsAgeRestrictedUser"
        - "CloudX.setIsUserConsent"

    - path: "docs/flutter/INTEGRATION_GUIDE.md"
      api_references:
        - "ALL"

    - path: "docs/flutter/ORCHESTRATION.md"
      api_references:
        - "ALL"

  ios:
    - path: ".claude/agents/ios/cloudx-ios-integrator.md"
      api_references:
        - "CloudXCore"
        - "initializeSDKWithAppKey:completion:"
        - "createBannerWithPlacement:viewController:delegate:tmax:"
        - "createInterstitialWithPlacement:delegate:tmax:"
        - "createRewardedWithPlacement:delegate:tmax:"
        - "createMRECWithPlacement:viewController:delegate:tmax:"
        - "createNativeWithPlacement:viewController:delegate:tmax:"
        - "CLXBannerDelegate"
        - "CLXInterstitialDelegate"
        - "CLXRewardedDelegate"
        - "CLXMRECDelegate"
        - "CLXNativeDelegate"
        - "showFromViewController:"
        - "setCCPAPrivacyString:"
        - "setIsUserConsent:"
        - "setIsAgeRestrictedUser:"

    - path: ".claude/agents/ios/cloudx-ios-auditor.md"
      api_references:
        - "bannerDidFailToLoad:withError:"
        - "interstitialDidFailToLoad:withError:"
        - "rewardedDidFailToLoad:withError:"
        - "initializeSDKWithAppKey:completion:"

    - path: ".claude/agents/ios/cloudx-ios-build-verifier.md"
      api_references:
        - "Xcode build validation"
        - "CocoaPods validation"
        - "SPM validation"

    - path: ".claude/agents/ios/cloudx-ios-privacy-checker.md"
      api_references:
        - "setCCPAPrivacyString:"
        - "setIsUserConsent:"
        - "setIsAgeRestrictedUser:"
        - "NSUserTrackingUsageDescription"
        - "requestTrackingAuthorization"

    - path: "docs/ios/SETUP.md"
      api_references:
        - "ALL"

    - path: "docs/ios/INTEGRATION_GUIDE.md"
      api_references:
        - "ALL"

    - path: "docs/ios/ORCHESTRATION.md"
      api_references:
        - "ALL"

# Update checklist (what to do when SDK version changes)
update_checklist:
  android:
    - "Update platforms.android.sdk_version field above"
    - "Run ./scripts/android/validate_agent_apis.sh"
    - "Review git diff for public API changes"
    - "Update agent files with new API names"
    - "Update code examples in docs/android/INTEGRATION_GUIDE.md"
    - "Run agent validation tests"
    - "Update platforms.android.agents_last_updated date"
    - "Commit with message: 'Update Android agents for SDK vX.X.X'"

  flutter:
    - "Update platforms.flutter.sdk_version field above"
    - "Run ./scripts/flutter/validate_agent_apis.sh"
    - "Review git diff for public API changes"
    - "Update agent files with new API names"
    - "Update code examples in docs/flutter/INTEGRATION_GUIDE.md"
    - "Run agent validation tests"
    - "Update platforms.flutter.agents_last_updated date"
    - "Commit with message: 'Update Flutter agents for SDK vX.X.X'"

  ios:
    - "Update platforms.ios.sdk_version field above"
    - "Run ./scripts/ios/validate_agent_apis.sh"
    - "Review git diff for public API changes (CloudXCoreAPI.h)"
    - "Update agent files with new API names (both Objective-C and Swift)"
    - "Update code examples in docs/ios/INTEGRATION_GUIDE.md"
    - "Verify both Objective-C and Swift examples compile"
    - "Run agent validation tests"
    - "Update platforms.ios.agents_last_updated date"
    - "Commit with message: 'Update iOS agents for SDK vX.X.X'"

# Known breaking changes to watch for
breaking_change_patterns:
  - "Renamed classes (e.g., CloudXInitParams → CloudXInitializationParams)"
  - "Changed method signatures (parameters added/removed)"
  - "Changed callback signatures"
  - "Removed deprecated APIs"
  - "Changed property types (method → property like isReady → isAdReady)"
  - "Changed parameter order"
  - "New required parameters"

# Contact for SDK changes
maintainer_contacts:
  sdk_team: "cloudx-sdk-team@example.com"
  agent_maintainer: "Update this with your contact"

# Validation coverage (what we actually check)
validation_coverage:
  what_we_validate:
    - "Class and interface names exist in SDK"
    - "Factory method names exist (createBanner, createInterstitial, etc.)"
    - "Privacy API class and field names correct"
    - "Deprecated API patterns not in agent docs (outside VALIDATION:IGNORE)"
    - "onAdLoaded callback signature uses CloudXAd parameter"

  what_we_dont_validate:
    - "Method signatures (parameter count, types, order)"
    - "Return types of methods"
    - "All callback signatures (only check 1 of 10+)"
    - "Code examples compile against SDK"
    - "New SDK features are documented"
    - "Removed SDK features cleaned from docs"
    - "Property vs method (isAdReady property vs isReady() method)"
    - "Required vs optional parameters"
    - "Complete API coverage (only ~20% of public APIs checked)"

  validation_level: "smoke_test"
  # Options: smoke_test, integration_test, comprehensive
  # Current: smoke_test - catches major breakage (renamed classes, removed methods)
  # Future: comprehensive - validates signatures, compiles examples, checks coverage

  known_risks:
    - "SDK could add new ad formats (native, MREC) - agents won't know"
    - "Method parameters could change - agents show wrong signature"
    - "New error codes added - agents can't help troubleshoot"
    - "Breaking changes in minor versions - validation might not catch"

  improvement_roadmap:
    - issue: "TBD"
      title: "Add code example compilation validation"
      priority: "P1"
      effort: "Medium"
    - issue: "TBD"
      title: "Add API coverage validation (check all public APIs documented)"
      priority: "P1"
      effort: "Low"
    - issue: "TBD"
      title: "Add reflection-based signature validation"
      priority: "P2"
      effort: "Medium"
    - issue: "TBD"
      title: "Add AST-based comprehensive validation"
      priority: "P2"
      effort: "High"
